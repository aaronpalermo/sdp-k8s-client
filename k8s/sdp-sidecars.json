{
    "containers": [
    {
        "env": [
            {
                "name": "CLIENT_LOGLEVEL",
                "valueFrom": {
                    "configMapKeyRef": {
                        "key": "client-loglevel",
                        "name": "sdp-injector-client-config"
                    }
                }
            },
            {
                "name": "CLIENT_CONTROLLER_URL",
                "valueFrom": {
                    "secretKeyRef": {
                        "key": "client-controller-url",
                        "name": "sdp-injector-client-secrets"
                    }
                }
            },
            {
                "name": "CLIENT_USERNAME",
                "valueFrom": {
                    "secretKeyRef": {
                        "key": "client-username",
                        "name": "sdp-injector-client-secrets"
                    }
                }
            },
            {
                "name": "CLIENT_PASSWORD",
                "valueFrom": {
                    "secretKeyRef": {
                        "key": "client-password",
                        "name": "sdp-injector-client-secrets"
                    }
                }
            }
        ],
        "image": "ghcr.io/appgate/sdp-k8s-client/sdp-headless-service",
        "imagePullPolicy": "Always",
        "name": "sdp-service",
        "resources": {},
        "terminationMessagePath": "/dev/termination-log",
        "terminationMessagePolicy": "File",
        "volumeMounts": [
            {
                "mountPath": "/var/run/appgate",
                "name": "run-appgate"
            }
        ]
    },
    {
        "image": "ghcr.io/appgate/sdp-k8s-client/sdp-headless-driver",
        "imagePullPolicy": "Always",
        "name": "sdp-driver",
        "env": [
            {
                "name": "POD_NODE",
                "valueFrom": {
                    "fieldRef": {
                        "fieldPath": "spec.nodeName"
                    }
                }
            },
	    {
		"name": "POD_NAME",
                "valueFrom": {
                    "fieldRef": {
                        "fieldPath": "metadata.name"
                    }
                }
	    },
	    {
                "name": "POD_NAMESPACE",
                "valueFrom": {
                    "fieldRef": {
                        "fieldPath": "metadata.namespace"
                    }
                }
            },
	    {
                "name": "POD_SERVICE_ACCOUNT",
                "valueFrom": {
                    "fieldRef": {
                        "fieldPath": "spec.serviceAccountName"
                    }
                }
            }
	],
        "securityContext": {
            "capabilities": {
                "add": [
                    "NET_ADMIN"
                ]
            }
        },
        "volumeMounts": [
            {
                "mountPath": "/var/run/appgate",
                "name": "run-appgate"
            },
            {
                "mountPath": "/dev/net/tun",
                "name": "tun-device"
            },
            {
                "mountPath": "/etc/pod-info",
                "name": "pod-info"
            }
        ]
    },
    {
        "command": [
            "/sdp-dnsmasq/sdp-dnsmasq"
        ],
        "image": "ghcr.io/appgate/sdp-k8s-client/sdp-dnsmasq",
        "imagePullPolicy": "Always",
        "name": "sdp-dnsmasq",
        "volumeMounts": [
            {
                "mountPath": "/var/run/appgate",
                "name": "run-appgate"
            }
        ]
    }
    ],
    "volumes": [
        {
            "mountPath": "/var/run/appgate",
            "name": "run-appgate"
        },
        {
            "hostPath": {
                "path": "/dev/net/tun"
            },
            "name": "tun-device"
        },
        {
            "name": "pod-info",
            "downwardAPI": {
                "items": [
                    {
                        "path": "labels",
                        "fieldRef": {
                            "fieldPath": "metadata.labels"
                        }
                    },
                    {
                        "path": "annotations",
                        "fieldRef": {
                            "fieldPath": "metadata.annotations"
                        }
                    }
                ]
            }
        }
    ]
}
